{"version":3,"file":"react-rnd.umd.js","sources":["../src/index.js"],"sourcesContent":["/* @flow */\n\nimport * as React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport Draggable from 'react-draggable';\nimport Resizable from 're-resizable';\nimport type { ResizeDirection, ResizeCallback, ResizeStartCallback } from 're-resizable';\n\nexport type Grid = [number, number];\n\nexport type Position = {\n  x: number,\n  y: number,\n};\n\nexport type DraggableData = {\n  node: HTMLElement,\n  deltaX: number,\n  deltaY: number,\n  lastX: number,\n  lastY: number,\n} & Position;\n\nexport type RndDragCallback = (e: Event, data: DraggableData) => void | false;\n\nexport type RndResizeStartCallback = (\n  e: SyntheticMouseEvent<HTMLDivElement> | SyntheticTouchEvent<HTMLDivElement>,\n  dir: ResizeDirection,\n  refToElement: React.ElementRef<'div'>,\n) => void;\n\nexport type ResizableDelta = {\n  width: number,\n  height: number,\n};\n\nexport type RndResizeCallback = (\n  e: MouseEvent | TouchEvent,\n  dir: ResizeDirection,\n  refToElement: React.ElementRef<'div'>,\n  delta: ResizableDelta,\n  position: Position,\n) => void;\n\ntype Size = {\n  width: string | number,\n  height: string | number,\n};\n\ntype State = {\n  z?: number,\n  original: Position,\n  bounds: {\n    top: number,\n    right: number,\n    bottom: number,\n    left: number,\n  },\n  maxWidth?: number | string,\n  maxHeight?: number | string,\n  isMounted: boolean,\n};\n\ntype MaxSize = {\n  maxWidth: number | string,\n  maxHeight: number | string,\n};\n\nexport type ResizeEnable = {\n  bottom?: boolean,\n  bottomLeft?: boolean,\n  bottomRight?: boolean,\n  left?: boolean,\n  right?: boolean,\n  top?: boolean,\n  topLeft?: boolean,\n  topRight?: boolean,\n};\n\nexport type HandleClasses = {\n  bottom?: string,\n  bottomLeft?: string,\n  bottomRight?: string,\n  left?: string,\n  right?: string,\n  top?: string,\n  topLeft?: string,\n  topRight?: string,\n};\n\ntype Style = {\n  [key: string]: string | number,\n};\n\nexport type HandleStyles = {\n  bottom?: Style,\n  bottomLeft?: Style,\n  bottomRight?: Style,\n  left?: Style,\n  right?: Style,\n  top?: Style,\n  topLeft?: Style,\n  topRight?: Style,\n};\n\ntype Props = {\n  z?: number,\n  dragGrid?: Grid,\n  default?: {\n    x: number,\n    y: number,\n  } & Size,\n  position?: {\n    x: number,\n    y: number,\n  },\n  size?: Size,\n  resizeGrid?: Grid,\n  bounds?: string,\n  onResizeStart?: RndResizeStartCallback,\n  onResize?: RndResizeCallback,\n  onResizeStop?: RndResizeCallback,\n  onDragStart?: RndDragCallback,\n  onDrag?: RndDragCallback,\n  onDragStop?: RndDragCallback,\n  className?: string,\n  style?: Style,\n  children?: React.Node,\n  enableResizing?: ResizeEnable,\n  extendsProps?: { [key: string]: any },\n  resizeHandleClasses?: HandleClasses,\n  resizeHandleStyles?: HandleStyles,\n  resizeHandleWrapperClass?: string,\n  resizeHandleWrapperStyle?: Style,\n  lockAspectRatio?: boolean | number,\n  lockAspectRatioExtraWidth?: number,\n  lockAspectRatioExtraHeight?: number,\n  maxHeight?: number | string,\n  maxWidth?: number | string,\n  minHeight?: number | string,\n  minWidth?: number | string,\n  dragAxis?: 'x' | 'y' | 'both' | 'none',\n  dragHandleClassName?: string,\n  disableDragging?: boolean,\n  cancel?: boolean,\n  enableUserSelectHack?: boolean,\n  _freeBottomBounds?: boolean, // Back door for react-elastic-grid.\n};\n\nconst resizableStyle = {\n  width: 'auto',\n  height: 'auto',\n  display: 'inline-block',\n  position: 'absolute',\n  top: 0,\n  left: 0,\n};\n\nexport default class Rnd extends React.Component<Props, State> {\n  static defaultProps = {\n    maxWidth: Number.MAX_SAFE_INTEGER,\n    maxHeight: Number.MAX_SAFE_INTEGER,\n    onResizeStart: () => {},\n    onResize: () => {},\n    onResizeStop: () => {},\n    onDragStart: () => {},\n    onDrag: () => {},\n    onDragStop: () => {},\n  };\n  resizable: React$ElementRef<typeof Resizable> | null;\n  draggable: Draggable;\n  onResizeStart: ResizeStartCallback;\n  onResize: ResizeCallback;\n  onResizeStop: ResizeCallback;\n  onDragStart: RndDragCallback;\n  onDrag: RndDragCallback;\n  onDragStop: RndDragCallback;\n  getMaxSizesFromProps: () => {\n    maxWidth: number | string,\n    maxHeight: number | string,\n  };\n  wrapper: HTMLElement;\n  parentId: string;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      z: props.z,\n      original: {\n        x: 0,\n        y: 0,\n      },\n      bounds: {\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n      },\n      maxWidth: props.maxWidth,\n      maxHeight: props.maxHeight,\n      isMounted: false,\n    };\n    this.onResizeStart = this.onResizeStart.bind(this);\n    this.onResize = this.onResize.bind(this);\n    this.onResizeStop = this.onResizeStop.bind(this);\n    this.onDragStart = this.onDragStart.bind(this);\n    this.onDrag = this.onDrag.bind(this);\n    this.onDragStop = this.onDragStop.bind(this);\n    this.getMaxSizesFromProps = this.getMaxSizesFromProps.bind(this);\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (this.props.z !== nextProps.z) {\n      this.setState({ z: nextProps.z });\n    }\n  }\n\n  componentDidMount() {\n    this.setParentPosition();\n    this.setState({ isMounted: true });\n  }\n\n  getParentSize(): { width: number, height: number } {\n    return (this.resizable: any).getParentSize();\n  }\n\n  getMaxSizesFromProps(): MaxSize {\n    const maxWidth = typeof this.props.maxWidth === 'undefined' ? Number.MAX_SAFE_INTEGER : this.props.maxWidth;\n    const maxHeight = typeof this.props.maxHeight === 'undefined' ? Number.MAX_SAFE_INTEGER : this.props.maxHeight;\n    return { maxWidth, maxHeight };\n  }\n\n  getSelfElement(): null | Element | Text {\n    if (!this) return null;\n    return findDOMNode(this);\n  }\n\n  setParentPosition() {\n    const element = this.getSelfElement();\n    if (element instanceof Element) {\n      const parent = element.parentNode;\n      if (!parent || typeof window === 'undefined') return;\n      if (!(parent instanceof HTMLElement)) return;\n      if (getComputedStyle(parent).position !== 'static') {\n        return;\n      }\n      parent.style.position = 'relative';\n    }\n  }\n\n  onDragStart(e: Event, data: DraggableData) {\n    if (this.props.onDragStart) {\n      this.props.onDragStart(e, data);\n    }\n    if (!this.props.bounds) return;\n    const parent = this.resizable && this.resizable.parentNode;\n    const target = this.props.bounds === 'parent' ? parent : document.querySelector(this.props.bounds);\n    if (!(target instanceof HTMLElement) || !(parent instanceof HTMLElement)) {\n      return;\n    }\n    const targetRect = target.getBoundingClientRect();\n    const targetLeft = targetRect.left;\n    const targetTop = targetRect.top;\n    const parentRect = parent.getBoundingClientRect();\n    const parentLeft = parentRect.left;\n    const parentTop = parentRect.top;\n    const left = targetLeft - parentLeft;\n    const top = targetTop - parentTop;\n    if (!this.resizable) return;\n    this.setState({\n      bounds: {\n        top,\n        right: left + (target.offsetWidth - this.resizable.size.width),\n        bottom: this.props._freeBottomBounds // eslint-disable-line\n          ? 2147483647\n          : top + (target.offsetHeight - this.resizable.size.height),\n        left,\n      },\n    });\n  }\n\n  onDrag(e: Event, data: DraggableData) {\n    if (this.props.onDrag) {\n      this.props.onDrag(e, data);\n    }\n  }\n\n  onDragStop(e: Event, data: DraggableData) {\n    if (this.props.onDragStop) {\n      this.props.onDragStop(e, data);\n    }\n  }\n\n  onResizeStart(\n    e: SyntheticMouseEvent<HTMLDivElement> | SyntheticTouchEvent<HTMLDivElement>,\n    dir: ResizeDirection,\n    refToElement: React.ElementRef<'div'>,\n  ) {\n    e.stopPropagation();\n    this.setState({\n      original: { x: this.draggable.state.x, y: this.draggable.state.y },\n    });\n    if (this.props.bounds) {\n      const parent = this.resizable && this.resizable.parentNode;\n      const target = this.props.bounds === 'parent' ? parent : document.querySelector(this.props.bounds);\n      const self = this.getSelfElement();\n      if (self instanceof Element && target instanceof HTMLElement && parent instanceof HTMLElement) {\n        let { maxWidth, maxHeight } = this.getMaxSizesFromProps();\n        const parentSize = this.getParentSize();\n        if (maxWidth && typeof maxWidth === 'string') {\n          if (maxWidth.endsWith('%')) {\n            const ratio = Number(maxWidth.replace('%', '')) / 100;\n            maxWidth = parentSize.width * ratio;\n          } else if (maxWidth.endsWith('px')) {\n            maxWidth = Number(maxWidth.replace('px', ''));\n          }\n        }\n        if (maxHeight && typeof maxHeight === 'string') {\n          if (maxHeight.endsWith('%')) {\n            const ratio = Number(maxHeight.replace('%', '')) / 100;\n            maxHeight = parentSize.width * ratio;\n          } else if (maxHeight.endsWith('px')) {\n            maxHeight = Number(maxHeight.replace('px', ''));\n          }\n        }\n        const selfRect = self.getBoundingClientRect();\n        const selfLeft = selfRect.left;\n        const selfTop = selfRect.top;\n        const targetRect = target.getBoundingClientRect();\n        const targetLeft = targetRect.left;\n        const targetTop = targetRect.top;\n        if (/left/i.test(dir) && this.resizable) {\n          const max = selfLeft - targetLeft + this.resizable.size.width;\n          this.setState({ maxWidth: max > Number(maxWidth) ? maxWidth : max });\n        }\n        if (/right/i.test(dir)) {\n          const max = target.offsetWidth + (targetLeft - selfLeft);\n          this.setState({ maxWidth: max > Number(maxWidth) ? maxWidth : max });\n        }\n        if (/top/i.test(dir) && this.resizable) {\n          const max = selfTop - targetTop + this.resizable.size.height;\n          this.setState({\n            maxHeight: max > Number(maxHeight) ? maxHeight : max,\n          });\n        }\n        if (/bottom/i.test(dir)) {\n          const max = target.offsetHeight + (targetTop - selfTop);\n          this.setState({\n            maxHeight: max > Number(maxHeight) ? maxHeight : max,\n          });\n        }\n      }\n    } else {\n      this.setState({\n        maxWidth: this.props.maxWidth,\n        maxHeight: this.props.maxHeight,\n      });\n    }\n    if (this.props.onResizeStart) {\n      this.props.onResizeStart(e, dir, refToElement);\n    }\n  }\n\n  onResize(\n    e: MouseEvent | TouchEvent,\n    direction: ResizeDirection,\n    refToResizableElement: React.ElementRef<'div'>,\n    delta: { height: number, width: number },\n  ) {\n    let x;\n    let y;\n    if (/left/i.test(direction)) {\n      x = this.state.original.x - delta.width;\n      this.draggable.setState({ x });\n    }\n    if (/top/i.test(direction)) {\n      y = this.state.original.y - delta.height;\n      this.draggable.setState({ y });\n    }\n    if (this.props.onResize) {\n      this.props.onResize(e, direction, refToResizableElement, delta, {\n        x: x || this.draggable.state.x,\n        y: y || this.draggable.state.y,\n      });\n    }\n  }\n\n  onResizeStop(\n    e: MouseEvent | TouchEvent,\n    direction: ResizeDirection,\n    refToResizableElement: HTMLDivElement,\n    delta: { height: number, width: number },\n  ) {\n    const { maxWidth, maxHeight } = this.getMaxSizesFromProps();\n    this.setState({ maxWidth, maxHeight });\n    if (this.props.onResizeStop) {\n      const position: Position = {\n        x: this.draggable.state.x,\n        y: this.draggable.state.y,\n      };\n      this.props.onResizeStop(e, direction, refToResizableElement, delta, position);\n    }\n  }\n\n  updateSize(size: { width: number | string, height: number | string }) {\n    if (!this.resizable) return;\n    this.resizable.updateSize({ width: size.width, height: size.height });\n  }\n\n  updatePosition(position: Position) {\n    this.draggable.setState(position);\n  }\n\n  updateZIndex(z: number) {\n    this.setState({ z });\n  }\n\n  render(): React.Node {\n    const cursorStyle =\n      this.props.disableDragging || this.props.dragHandleClassName ? { cursor: 'normal' } : { cursor: 'move' };\n    const innerStyle = {\n      ...resizableStyle,\n      zIndex: this.state.z,\n      ...cursorStyle,\n      ...this.props.style,\n    };\n    // HACK: Wait for setting relative to parent element.\n    if (!this.state.isMounted) return <div>{this.props.children}</div>;\n    const maxHeight = this.props._freeBottomBounds ? 2147483647 : this.state.maxHeight; // eslint-disable-line\n    return (\n      <Draggable\n        ref={(c: Draggable) => {\n          this.draggable = c;\n        }}\n        handle={this.props.dragHandleClassName}\n        defaultPosition={this.props.default}\n        onStart={this.onDragStart}\n        onDrag={this.onDrag}\n        onStop={this.onDragStop}\n        axis={this.props.dragAxis}\n        disabled={this.props.disableDragging}\n        grid={this.props.dragGrid}\n        bounds={this.props.bounds ? this.state.bounds : undefined}\n        position={this.props.position}\n        enableUserSelectHack={this.props.enableUserSelectHack}\n        cancel={this.props.cancel}\n      >\n        <Resizable\n          {...this.props.extendsProps}\n          className={this.props.className}\n          ref={(c: React$ElementRef<typeof Resizable> | null) => {\n            this.resizable = c;\n          }}\n          defaultSize={this.props.default}\n          size={this.props.size}\n          enable={this.props.enableResizing}\n          onResizeStart={this.onResizeStart}\n          onResize={this.onResize}\n          onResizeStop={this.onResizeStop}\n          style={innerStyle}\n          minWidth={this.props.minWidth}\n          minHeight={this.props.minHeight}\n          maxWidth={this.state.maxWidth}\n          maxHeight={maxHeight}\n          grid={this.props.resizeGrid}\n          handleWrapperClass={this.props.resizeHandleWrapperClass}\n          handleWrapperStyle={this.props.resizeHandleWrapperStyle}\n          lockAspectRatio={this.props.lockAspectRatio}\n          lockAspectRatioExtraWidth={this.props.lockAspectRatioExtraWidth}\n          lockAspectRatioExtraHeight={this.props.lockAspectRatioExtraHeight}\n          handleStyles={this.props.resizeHandleStyles}\n          handleClasses={this.props.resizeHandleClasses}\n        >\n          {this.props.children}\n        </Resizable>\n      </Draggable>\n    );\n  }\n}\n"],"names":["resizableStyle","width","height","display","position","top","left","Rnd","props","state","z","original","x","y","bounds","right","bottom","maxWidth","maxHeight","isMounted","onResizeStart","bind","onResize","onResizeStop","onDragStart","onDrag","onDragStop","getMaxSizesFromProps","nextProps","setState","setParentPosition","resizable","getParentSize","Number","MAX_SAFE_INTEGER","findDOMNode","element","getSelfElement","Element","parent","parentNode","window","HTMLElement","getComputedStyle","style","e","data","target","document","querySelector","targetRect","getBoundingClientRect","targetLeft","targetTop","parentRect","parentLeft","parentTop","offsetWidth","size","_freeBottomBounds","offsetHeight","dir","refToElement","stopPropagation","draggable","self","parentSize","endsWith","ratio","replace","selfRect","selfLeft","selfTop","test","max","direction","refToResizableElement","delta","updateSize","cursorStyle","disableDragging","dragHandleClassName","cursor","innerStyle","zIndex","React.createElement","children","c","default","dragAxis","dragGrid","undefined","enableUserSelectHack","cancel","extendsProps","className","enableResizing","minWidth","minHeight","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","resizeHandleStyles","resizeHandleClasses","React","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAqJA,IAAMA,iBAAiB;EACrBC,SAAO,MADc;EAErBC,UAAQ,MAFa;EAGrBC,WAAS,cAHY;EAIrBC,YAAU,UAJW;EAKrBC,OAAK,CALgB;EAMrBC,QAAM;EANe,CAAvB;;MASqBC;;;EA0BnB,eAAYC,KAAZ,EAA0B;EAAA;;EAAA,yGAClBA,KADkB;;EAExB,UAAKC,KAAL,GAAa;EACXC,SAAGF,MAAME,CADE;EAEXC,gBAAU;EACRC,WAAG,CADK;EAERC,WAAG;EAFK,OAFC;EAMXC,cAAQ;EACNT,aAAK,CADC;EAENU,eAAO,CAFD;EAGNC,gBAAQ,CAHF;EAINV,cAAM;EAJA,OANG;EAYXW,gBAAUT,MAAMS,QAZL;EAaXC,iBAAWV,MAAMU,SAbN;EAcXC,iBAAW;EAdA,KAAb;EAgBA,UAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBC,IAAnB,OAArB;EACA,UAAKC,QAAL,GAAgB,MAAKA,QAAL,CAAcD,IAAd,OAAhB;EACA,UAAKE,YAAL,GAAoB,MAAKA,YAAL,CAAkBF,IAAlB,OAApB;EACA,UAAKG,WAAL,GAAmB,MAAKA,WAAL,CAAiBH,IAAjB,OAAnB;EACA,UAAKI,MAAL,GAAc,MAAKA,MAAL,CAAYJ,IAAZ,OAAd;EACA,UAAKK,UAAL,GAAkB,MAAKA,UAAL,CAAgBL,IAAhB,OAAlB;EACA,UAAKM,oBAAL,GAA4B,MAAKA,oBAAL,CAA0BN,IAA1B,OAA5B;EAxBwB;EAyBzB;;;;gDAEyBO,WAAkB;EAC1C,UAAI,KAAKpB,KAAL,CAAWE,CAAX,KAAiBkB,UAAUlB,CAA/B,EAAkC;EAChC,aAAKmB,QAAL,CAAc,EAAEnB,GAAGkB,UAAUlB,CAAf,EAAd;EACD;EACF;;;0CAEmB;EAClB,WAAKoB,iBAAL;EACA,WAAKD,QAAL,CAAc,EAAEV,WAAW,IAAb,EAAd;EACD;;;sCAEkD;EACjD,aAAQ,KAAKY,SAAN,CAAsBC,aAAtB,EAAP;EACD;;;6CAE+B;EAC9B,UAAMf,WAAW,OAAO,KAAKT,KAAL,CAAWS,QAAlB,KAA+B,WAA/B,GAA6CgB,OAAOC,gBAApD,GAAuE,KAAK1B,KAAL,CAAWS,QAAnG;EACA,UAAMC,YAAY,OAAO,KAAKV,KAAL,CAAWU,SAAlB,KAAgC,WAAhC,GAA8Ce,OAAOC,gBAArD,GAAwE,KAAK1B,KAAL,CAAWU,SAArG;EACA,aAAO,EAAED,kBAAF,EAAYC,oBAAZ,EAAP;EACD;;;uCAEuC;EACtC,UAAI,CAAC,IAAL,EAAW,OAAO,IAAP;EACX,aAAOiB,qBAAY,IAAZ,CAAP;EACD;;;0CAEmB;EAClB,UAAMC,UAAU,KAAKC,cAAL,EAAhB;EACA,UAAID,mBAAmBE,OAAvB,EAAgC;EAC9B,YAAMC,SAASH,QAAQI,UAAvB;EACA,YAAI,CAACD,MAAD,IAAW,OAAOE,MAAP,KAAkB,WAAjC,EAA8C;EAC9C,YAAI,EAAEF,kBAAkBG,WAApB,CAAJ,EAAsC;EACtC,YAAIC,iBAAiBJ,MAAjB,EAAyBnC,QAAzB,KAAsC,QAA1C,EAAoD;EAClD;EACD;EACDmC,eAAOK,KAAP,CAAaxC,QAAb,GAAwB,UAAxB;EACD;EACF;;;kCAEWyC,GAAUC,MAAqB;EACzC,UAAI,KAAKtC,KAAL,CAAWgB,WAAf,EAA4B;EAC1B,aAAKhB,KAAL,CAAWgB,WAAX,CAAuBqB,CAAvB,EAA0BC,IAA1B;EACD;EACD,UAAI,CAAC,KAAKtC,KAAL,CAAWM,MAAhB,EAAwB;EACxB,UAAMyB,SAAS,KAAKR,SAAL,IAAkB,KAAKA,SAAL,CAAeS,UAAhD;EACA,UAAMO,SAAS,KAAKvC,KAAL,CAAWM,MAAX,KAAsB,QAAtB,GAAiCyB,MAAjC,GAA0CS,SAASC,aAAT,CAAuB,KAAKzC,KAAL,CAAWM,MAAlC,CAAzD;EACA,UAAI,EAAEiC,kBAAkBL,WAApB,KAAoC,EAAEH,kBAAkBG,WAApB,CAAxC,EAA0E;EACxE;EACD;EACD,UAAMQ,aAAaH,OAAOI,qBAAP,EAAnB;EACA,UAAMC,aAAaF,WAAW5C,IAA9B;EACA,UAAM+C,YAAYH,WAAW7C,GAA7B;EACA,UAAMiD,aAAaf,OAAOY,qBAAP,EAAnB;EACA,UAAMI,aAAaD,WAAWhD,IAA9B;EACA,UAAMkD,YAAYF,WAAWjD,GAA7B;EACA,UAAMC,OAAO8C,aAAaG,UAA1B;EACA,UAAMlD,MAAMgD,YAAYG,SAAxB;EACA,UAAI,CAAC,KAAKzB,SAAV,EAAqB;EACrB,WAAKF,QAAL,CAAc;EACZf,gBAAQ;EACNT,kBADM;EAENU,iBAAOT,QAAQyC,OAAOU,WAAP,GAAqB,KAAK1B,SAAL,CAAe2B,IAAf,CAAoBzD,KAAjD,CAFD;EAGNe,kBAAQ,KAAKR,KAAL,CAAWmD,iBAAX;EAAA,YACJ,UADI,GAEJtD,OAAO0C,OAAOa,YAAP,GAAsB,KAAK7B,SAAL,CAAe2B,IAAf,CAAoBxD,MAAjD,CALE;EAMNI;EANM;EADI,OAAd;EAUD;;;6BAEMuC,GAAUC,MAAqB;EACpC,UAAI,KAAKtC,KAAL,CAAWiB,MAAf,EAAuB;EACrB,aAAKjB,KAAL,CAAWiB,MAAX,CAAkBoB,CAAlB,EAAqBC,IAArB;EACD;EACF;;;iCAEUD,GAAUC,MAAqB;EACxC,UAAI,KAAKtC,KAAL,CAAWkB,UAAf,EAA2B;EACzB,aAAKlB,KAAL,CAAWkB,UAAX,CAAsBmB,CAAtB,EAAyBC,IAAzB;EACD;EACF;;;oCAGCD,GACAgB,KACAC,cACA;EACAjB,QAAEkB,eAAF;EACA,WAAKlC,QAAL,CAAc;EACZlB,kBAAU,EAAEC,GAAG,KAAKoD,SAAL,CAAevD,KAAf,CAAqBG,CAA1B,EAA6BC,GAAG,KAAKmD,SAAL,CAAevD,KAAf,CAAqBI,CAArD;EADE,OAAd;EAGA,UAAI,KAAKL,KAAL,CAAWM,MAAf,EAAuB;EACrB,YAAMyB,SAAS,KAAKR,SAAL,IAAkB,KAAKA,SAAL,CAAeS,UAAhD;EACA,YAAMO,SAAS,KAAKvC,KAAL,CAAWM,MAAX,KAAsB,QAAtB,GAAiCyB,MAAjC,GAA0CS,SAASC,aAAT,CAAuB,KAAKzC,KAAL,CAAWM,MAAlC,CAAzD;EACA,YAAMmD,OAAO,KAAK5B,cAAL,EAAb;EACA,YAAI4B,gBAAgB3B,OAAhB,IAA2BS,kBAAkBL,WAA7C,IAA4DH,kBAAkBG,WAAlF,EAA+F;EAAA,sCAC/D,KAAKf,oBAAL,EAD+D;EAAA,cACvFV,SADuF,yBACvFA,QADuF;EAAA,cAC7EC,UAD6E,yBAC7EA,SAD6E;;EAE7F,cAAMgD,aAAa,KAAKlC,aAAL,EAAnB;EACA,cAAIf,aAAY,OAAOA,SAAP,KAAoB,QAApC,EAA8C;EAC5C,gBAAIA,UAASkD,QAAT,CAAkB,GAAlB,CAAJ,EAA4B;EAC1B,kBAAMC,QAAQnC,OAAOhB,UAASoD,OAAT,CAAiB,GAAjB,EAAsB,EAAtB,CAAP,IAAoC,GAAlD;EACApD,0BAAWiD,WAAWjE,KAAX,GAAmBmE,KAA9B;EACD,aAHD,MAGO,IAAInD,UAASkD,QAAT,CAAkB,IAAlB,CAAJ,EAA6B;EAClClD,0BAAWgB,OAAOhB,UAASoD,OAAT,CAAiB,IAAjB,EAAuB,EAAvB,CAAP,CAAX;EACD;EACF;EACD,cAAInD,cAAa,OAAOA,UAAP,KAAqB,QAAtC,EAAgD;EAC9C,gBAAIA,WAAUiD,QAAV,CAAmB,GAAnB,CAAJ,EAA6B;EAC3B,kBAAMC,SAAQnC,OAAOf,WAAUmD,OAAV,CAAkB,GAAlB,EAAuB,EAAvB,CAAP,IAAqC,GAAnD;EACAnD,2BAAYgD,WAAWjE,KAAX,GAAmBmE,MAA/B;EACD,aAHD,MAGO,IAAIlD,WAAUiD,QAAV,CAAmB,IAAnB,CAAJ,EAA8B;EACnCjD,2BAAYe,OAAOf,WAAUmD,OAAV,CAAkB,IAAlB,EAAwB,EAAxB,CAAP,CAAZ;EACD;EACF;EACD,cAAMC,WAAWL,KAAKd,qBAAL,EAAjB;EACA,cAAMoB,WAAWD,SAAShE,IAA1B;EACA,cAAMkE,UAAUF,SAASjE,GAAzB;EACA,cAAM6C,aAAaH,OAAOI,qBAAP,EAAnB;EACA,cAAMC,aAAaF,WAAW5C,IAA9B;EACA,cAAM+C,YAAYH,WAAW7C,GAA7B;EACA,cAAI,QAAQoE,IAAR,CAAaZ,GAAb,KAAqB,KAAK9B,SAA9B,EAAyC;EACvC,gBAAM2C,MAAMH,WAAWnB,UAAX,GAAwB,KAAKrB,SAAL,CAAe2B,IAAf,CAAoBzD,KAAxD;EACA,iBAAK4B,QAAL,CAAc,EAAEZ,UAAUyD,MAAMzC,OAAOhB,SAAP,CAAN,GAAyBA,SAAzB,GAAoCyD,GAAhD,EAAd;EACD;EACD,cAAI,SAASD,IAAT,CAAcZ,GAAd,CAAJ,EAAwB;EACtB,gBAAMa,OAAM3B,OAAOU,WAAP,IAAsBL,aAAamB,QAAnC,CAAZ;EACA,iBAAK1C,QAAL,CAAc,EAAEZ,UAAUyD,OAAMzC,OAAOhB,SAAP,CAAN,GAAyBA,SAAzB,GAAoCyD,IAAhD,EAAd;EACD;EACD,cAAI,OAAOD,IAAP,CAAYZ,GAAZ,KAAoB,KAAK9B,SAA7B,EAAwC;EACtC,gBAAM2C,QAAMF,UAAUnB,SAAV,GAAsB,KAAKtB,SAAL,CAAe2B,IAAf,CAAoBxD,MAAtD;EACA,iBAAK2B,QAAL,CAAc;EACZX,yBAAWwD,QAAMzC,OAAOf,UAAP,CAAN,GAA0BA,UAA1B,GAAsCwD;EADrC,aAAd;EAGD;EACD,cAAI,UAAUD,IAAV,CAAeZ,GAAf,CAAJ,EAAyB;EACvB,gBAAMa,QAAM3B,OAAOa,YAAP,IAAuBP,YAAYmB,OAAnC,CAAZ;EACA,iBAAK3C,QAAL,CAAc;EACZX,yBAAWwD,QAAMzC,OAAOf,UAAP,CAAN,GAA0BA,UAA1B,GAAsCwD;EADrC,aAAd;EAGD;EACF;EACF,OAlDD,MAkDO;EACL,aAAK7C,QAAL,CAAc;EACZZ,oBAAU,KAAKT,KAAL,CAAWS,QADT;EAEZC,qBAAW,KAAKV,KAAL,CAAWU;EAFV,SAAd;EAID;EACD,UAAI,KAAKV,KAAL,CAAWY,aAAf,EAA8B;EAC5B,aAAKZ,KAAL,CAAWY,aAAX,CAAyByB,CAAzB,EAA4BgB,GAA5B,EAAiCC,YAAjC;EACD;EACF;;;+BAGCjB,GACA8B,WACAC,uBACAC,OACA;EACA,UAAIjE,UAAJ;EACA,UAAIC,UAAJ;EACA,UAAI,QAAQ4D,IAAR,CAAaE,SAAb,CAAJ,EAA6B;EAC3B/D,YAAI,KAAKH,KAAL,CAAWE,QAAX,CAAoBC,CAApB,GAAwBiE,MAAM5E,KAAlC;EACA,aAAK+D,SAAL,CAAenC,QAAf,CAAwB,EAAEjB,IAAF,EAAxB;EACD;EACD,UAAI,OAAO6D,IAAP,CAAYE,SAAZ,CAAJ,EAA4B;EAC1B9D,YAAI,KAAKJ,KAAL,CAAWE,QAAX,CAAoBE,CAApB,GAAwBgE,MAAM3E,MAAlC;EACA,aAAK8D,SAAL,CAAenC,QAAf,CAAwB,EAAEhB,IAAF,EAAxB;EACD;EACD,UAAI,KAAKL,KAAL,CAAWc,QAAf,EAAyB;EACvB,aAAKd,KAAL,CAAWc,QAAX,CAAoBuB,CAApB,EAAuB8B,SAAvB,EAAkCC,qBAAlC,EAAyDC,KAAzD,EAAgE;EAC9DjE,aAAGA,KAAK,KAAKoD,SAAL,CAAevD,KAAf,CAAqBG,CADiC;EAE9DC,aAAGA,KAAK,KAAKmD,SAAL,CAAevD,KAAf,CAAqBI;EAFiC,SAAhE;EAID;EACF;;;mCAGCgC,GACA8B,WACAC,uBACAC,OACA;EAAA,mCACgC,KAAKlD,oBAAL,EADhC;EAAA,UACQV,QADR,0BACQA,QADR;EAAA,UACkBC,SADlB,0BACkBA,SADlB;;EAEA,WAAKW,QAAL,CAAc,EAAEZ,kBAAF,EAAYC,oBAAZ,EAAd;EACA,UAAI,KAAKV,KAAL,CAAWe,YAAf,EAA6B;EAC3B,YAAMnB,YAAqB;EACzBQ,aAAG,KAAKoD,SAAL,CAAevD,KAAf,CAAqBG,CADC;EAEzBC,aAAG,KAAKmD,SAAL,CAAevD,KAAf,CAAqBI;EAFC,SAA3B;EAIA,aAAKL,KAAL,CAAWe,YAAX,CAAwBsB,CAAxB,EAA2B8B,SAA3B,EAAsCC,qBAAtC,EAA6DC,KAA7D,EAAoEzE,SAApE;EACD;EACF;;;iCAEUsD,MAA2D;EACpE,UAAI,CAAC,KAAK3B,SAAV,EAAqB;EACrB,WAAKA,SAAL,CAAe+C,UAAf,CAA0B,EAAE7E,OAAOyD,KAAKzD,KAAd,EAAqBC,QAAQwD,KAAKxD,MAAlC,EAA1B;EACD;;;qCAEcE,UAAoB;EACjC,WAAK4D,SAAL,CAAenC,QAAf,CAAwBzB,QAAxB;EACD;;;mCAEYM,GAAW;EACtB,WAAKmB,QAAL,CAAc,EAAEnB,IAAF,EAAd;EACD;;;+BAEoB;EAAA;;EACnB,UAAMqE,cACJ,KAAKvE,KAAL,CAAWwE,eAAX,IAA8B,KAAKxE,KAAL,CAAWyE,mBAAzC,GAA+D,EAAEC,QAAQ,QAAV,EAA/D,GAAsF,EAAEA,QAAQ,MAAV,EADxF;EAEA,UAAMC,0BACDnF,cADC;EAEJoF,gBAAQ,KAAK3E,KAAL,CAAWC;EAFf,SAGDqE,WAHC,EAID,KAAKvE,KAAL,CAAWoC,KAJV,CAAN;EAMA;EACA,UAAI,CAAC,KAAKnC,KAAL,CAAWU,SAAhB,EAA2B,OAAOkE;EAAA;EAAA;EAAM,aAAK7E,KAAL,CAAW8E;EAAjB,OAAP;EAC3B,UAAMpE,YAAY,KAAKV,KAAL,CAAWmD,iBAAX,GAA+B,UAA/B,GAA4C,KAAKlD,KAAL,CAAWS,SAAzE,CAXmB;EAYnB,aACEmE;EAAC,iBAAD;EAAA;EACE,eAAK,aAACE,CAAD,EAAkB;EACrB,mBAAKvB,SAAL,GAAiBuB,CAAjB;EACD,WAHH;EAIE,kBAAQ,KAAK/E,KAAL,CAAWyE,mBAJrB;EAKE,2BAAiB,KAAKzE,KAAL,CAAWgF,OAL9B;EAME,mBAAS,KAAKhE,WANhB;EAOE,kBAAQ,KAAKC,MAPf;EAQE,kBAAQ,KAAKC,UARf;EASE,gBAAM,KAAKlB,KAAL,CAAWiF,QATnB;EAUE,oBAAU,KAAKjF,KAAL,CAAWwE,eAVvB;EAWE,gBAAM,KAAKxE,KAAL,CAAWkF,QAXnB;EAYE,kBAAQ,KAAKlF,KAAL,CAAWM,MAAX,GAAoB,KAAKL,KAAL,CAAWK,MAA/B,GAAwC6E,SAZlD;EAaE,oBAAU,KAAKnF,KAAL,CAAWJ,QAbvB;EAcE,gCAAsB,KAAKI,KAAL,CAAWoF,oBAdnC;EAeE,kBAAQ,KAAKpF,KAAL,CAAWqF;EAfrB;EAiBE;EAAC,mBAAD;EAAA,uBACM,KAAKrF,KAAL,CAAWsF,YADjB;EAEE,uBAAW,KAAKtF,KAAL,CAAWuF,SAFxB;EAGE,iBAAK,aAACR,CAAD,EAAkD;EACrD,qBAAKxD,SAAL,GAAiBwD,CAAjB;EACD,aALH;EAME,yBAAa,KAAK/E,KAAL,CAAWgF,OAN1B;EAOE,kBAAM,KAAKhF,KAAL,CAAWkD,IAPnB;EAQE,oBAAQ,KAAKlD,KAAL,CAAWwF,cARrB;EASE,2BAAe,KAAK5E,aATtB;EAUE,sBAAU,KAAKE,QAVjB;EAWE,0BAAc,KAAKC,YAXrB;EAYE,mBAAO4D,UAZT;EAaE,sBAAU,KAAK3E,KAAL,CAAWyF,QAbvB;EAcE,uBAAW,KAAKzF,KAAL,CAAW0F,SAdxB;EAeE,sBAAU,KAAKzF,KAAL,CAAWQ,QAfvB;EAgBE,uBAAWC,SAhBb;EAiBE,kBAAM,KAAKV,KAAL,CAAW2F,UAjBnB;EAkBE,gCAAoB,KAAK3F,KAAL,CAAW4F,wBAlBjC;EAmBE,gCAAoB,KAAK5F,KAAL,CAAW6F,wBAnBjC;EAoBE,6BAAiB,KAAK7F,KAAL,CAAW8F,eApB9B;EAqBE,uCAA2B,KAAK9F,KAAL,CAAW+F,yBArBxC;EAsBE,wCAA4B,KAAK/F,KAAL,CAAWgG,0BAtBzC;EAuBE,0BAAc,KAAKhG,KAAL,CAAWiG,kBAvB3B;EAwBE,2BAAe,KAAKjG,KAAL,CAAWkG;EAxB5B;EA0BG,eAAKlG,KAAL,CAAW8E;EA1Bd;EAjBF,OADF;EAgDD;;;IA/T8BqB;;EAAZpG,IACZqG,eAAe;EACpB3F,YAAUgB,OAAOC,gBADG;EAEpBhB,aAAWe,OAAOC,gBAFE;EAGpBd,iBAAe,yBAAM,EAHD;EAIpBE,YAAU,oBAAM,EAJI;EAKpBC,gBAAc,wBAAM,EALA;EAMpBC,eAAa,uBAAM,EANC;EAOpBC,UAAQ,kBAAM,EAPM;EAQpBC,cAAY,sBAAM;EARE;;;;;;;;;;;;"}